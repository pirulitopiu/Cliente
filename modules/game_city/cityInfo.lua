local areas = {
	{from = {x = 1047, y = 999, z = 7}, to = {x = 1057, y = 1009, z = 7}, priority = 0, name = 'Saffron City'}, -- 1 entrada	
	{from = {x = 987, y = 1043, z = 7}, to = {x = 992, y = 1047, z = 7}, priority = 0, name = 'Saffron City'}, -- 2 entrada	
	{from = {x = 1092, y = 1010, z = 7}, to = {x = 1094, y = 1022, z = 7}, priority = 0, name = 'Saffron City'}, -- 3 entrada
	{from = {x = 1040, y = 1085, z = 7}, to = {x = 1049, y = 1088, z = 7}, priority = 0, name = 'Saffron City'}, -- 4 entrada
	{from = {x = 1053, y = 919, z = 7}, to = {x = 1061, y = 922, z = 7}, priority = 0, name = 'Cerulean City'}, -- 1 entrada
	{from = {x = 1082, y = 895, z = 7}, to = {x = 1088, y = 899, z = 7}, priority = 0, name = 'Cerulean City'}, -- 2 entrada
	{from = {x = 982, y = 902, z = 7}, to = {x = 990, y = 907, z = 7}, priority = 0, name = 'Cerulean City'}, -- 3 entrada
	{from = {x = 1037, y = 862, z = 7}, to = {x = 1049, y = 867, z = 7}, priority = 0, name = 'Cerulean City'}, -- 4 entrada	
	{from = {x = 1178, y = 1027, z = 7}, to = {x = 1185, y = 1037, z = 7}, priority = 0, name = 'Lavender City'}, -- 1 entrada
	{from = {x = 1188, y = 1050, z = 7}, to = {x = 1198, y = 1056, z = 7}, priority = 0, name = 'Lavender City'}, -- 2 entrada
	{from = {x = 1230, y = 1487, z = 6}, to = {x = 1235, y = 1494, z = 7}, priority = 0, name = 'Fuchsia City'}, -- 1 entrada
	{from = {x = 840, y = 996, z = 6}, to = {x = 847, y = 1001, z = 6}, priority = 0, name = 'Celadon City'}, -- 1 entrada
	{from = {x = 920, y = 1029, z = 6}, to = {x = 926, y = 1035, z = 6}, priority = 0, name = 'Celadon City'}, -- 2 entrada
	{from = {x = 705, y = 1086, z = 7}, to = {x = 707, y = 1087, z = 7}, priority = 0, name = 'Viridian City'}, -- 1 entrada
	{from = {x = 709, y = 1035, z = 7}, to = {x = 711, y = 1036, z = 7}, priority = 0, name = 'Viridian City'}, -- 2 entrada
	{from = {x = 712, y = 863, z = 7}, to = {x = 714, y = 868, z = 7}, priority = 0, name = 'Pewter City'}, -- 1 entrada
	{from = {x = 741, y = 835, z = 7}, to = {x = 749, y = 837, z = 7}, priority = 0, name = 'Pewter City'}, -- 2 entrada
	{from = {x = 1019, y = 1173, z = 7}, to = {x = 1023, y = 1177, z = 7}, priority = 0, name = 'Vermilion City'}, -- 1 entrada	
	{from = {x = 1059, y = 1255, z = 7}, to = {x = 1065, y = 1262, z = 7}, priority = 0, name = 'Vermilion City'}, -- 2 entrada	
	{from = {x = 744, y = 1309, z = 7}, to = {x = 747, y = 1311, z = 7}, priority = 0, name = 'Cinnabar City'}, -- 1 entrada
	{from = {x = 1648, y = 1033, z = 6}, to = {x = 1651, y = 1038, z = 6}, priority = 0, name = 'Alagoinha City'}, -- 1 entrada	
	{from = {x = 785, y = 2664, z = 7}, to = {x = 792, y = 2669, z = 7}, priority = 0, name = 'Goldenrod City'}, -- 1 entrada
	{from = {x = 834, y = 2747, z = 7}, to = {x = 839, y = 2753, z = 7}, priority = 0, name = 'Goldenrod City'}, -- 2 entrada
	{from = {x = 784, y = 2800, z = 7}, to = {x = 790, y = 2806, z = 7}, priority = 0, name = 'Azalea City'}, -- 1 entrada
	{from = {x = 840, y = 2806, z = 7}, to = {x = 846, y = 2811, z = 7}, priority = 0, name = 'Azalea City'}, -- 2 entrada	
	{from = {x = 867, y = 2568, z = 7}, to = {x = 874, y = 2569, z = 7}, priority = 0, name = 'Ecruteak City'}, -- 1 entrada
	{from = {x = 855, y = 2528, z = 7}, to = {x = 859, y = 2536, z = 7}, priority = 0, name = 'Ecruteak City'}, -- 2 entrada
	{from = {x = 700, y = 2577, z = 7}, to = {x = 706, y = 2581, z = 7}, priority = 0, name = 'Olivine City'}, -- 1 entrada	
	{from = {x = 1059, y = 2650, z = 7}, to = {x = 1060, y = 2657, z = 7}, priority = 0, name = 'Violet City'}, -- 1 entrada
	{from = {x = 955, y = 2660, z = 7}, to = {x = 962, y = 2667, z = 7}, priority = 0, name = 'Violet City'}, -- 2 entrada	
	{from = {x = 1240, y = 2703, z = 7}, to = {x = 1246, y = 2708, z = 7}, priority = 0, name = 'NewBark City'}, -- 1 entrada
	{from = {x = 1107, y = 2678, z = 7}, to = {x = 1114, y = 2681, z = 7}, priority = 0, name = 'Cherrygrove City'}, -- 1 entrada
	{from = {x = 1160, y = 2697, z = 7}, to = {x = 1165, y = 2703, z = 7}, priority = 0, name = 'Cherrygrove City'}, -- 2 entrada	
	{from = {x = 1000, y = 2546, z = 7}, to = {x = 1006, y = 2554, z = 7}, priority = 0, name = 'Mahogany City'}, -- 1 entrada
	{from = {x = 1035, y = 2533, z = 7}, to = {x = 1044, y = 2537, z = 7}, priority = 0, name = 'Mahogany City'}, -- 2 entrada	
	{from = {x = 1072, y = 2543, z = 7}, to = {x = 1076, y = 2549, z = 7}, priority = 0, name = 'Mahogany City'}, -- 3 entrada
	{from = {x = 1203, y = 2584, z = 7}, to = {x = 1211, y = 2589, z = 7}, priority = 0, name = 'Blackthorn City'}, -- 1 entrada		
	}  
local area = nil
local intervalo = 1
local duracao = 5
local retorno = 0
local eventAnimation = nil
local check = true
function isInRange(pos, fromPos, toPos)
    return
        pos.x>=fromPos.x and
        pos.y>=fromPos.y and
        pos.z>=fromPos.z and
        pos.x<=toPos.x and
        pos.y<=toPos.y and
        pos.z<=toPos.z
end

function init()
	placa = g_ui.displayUI('cityInfo', modules.game_interface.getRootPanel())
	placa:setVisible(false) 
	
	placaLabel = placa:getChildById('nome')
	
	connect(g_game, { onGameStart = updatePosition})
	connect(g_game, { onGameStart = AdjustSize})
	
	connect(LocalPlayer, {
		onPositionChange = updatePosition
	})
end
function AdjustSize()
	local top = (g_window.getHeight()/2) - 65
	placa:setMarginTop(-top)
end

function terminate()
	placa:destroy()
end

function updatePosition()
	local player = g_game.getLocalPlayer()
	if not player then
		return 
	end
	local pos = player:getPosition()
	if not pos then return end
	check = false
	local prioridade = nil
	for i = 1, #areas do
		if isInRange(pos, areas[i].from, areas[i].to) then
			if prioridade == nil then
				prioridade = areas[i].priority
				Table = areas[i]
			end
			
			if areas[i].priority > prioridade then
				Table = areas[i]
				prioridade = areas[i].priority
			end
			check = true
		end
	end
	if check == true then
		if Table.name == area then
			return false
		else
			reset()
			area = Table.name
			retorno = 1
			placaLabel:setText(area)
			placa:setVisible(true) 
			eventAnimation = cycleEvent(function() showPlaca(retorno) end, 200)
			check = true
		end
	else
		reset()	
	end
end

function reset()
	area = nil
	removeEvent(eventAnimation)
	removeEvent(placa.fadeEvent)
	g_effects.fadeOut(placa, 0) 
	placa:setVisible(false)	
end
function showPlaca()
	if retorno == 1 then
		g_effects.fadeIn(placa, 1100)
		retorno = 2
		removeEvent(eventAnimation)
		eventAnimation = cycleEvent(function() showPlaca(retorno) end, 2500)
		return
	elseif retorno == 2 then
		g_effects.fadeOut(placa, 1100)
		retorno = 0
		removeEvent(eventAnimation)
	end
end
